## [K8S room](https://tryhackme.com/r/room/k8sruntimesecurity)

Tags: #easy #walkthrough #k8s #kubernetes #security #runtime #forensics #falco #tool-description
Thoughts:
I work with k8s on a daily basis, so I'm familiar with most of the concepts
Not a lot to learn here

**`/dev/null` Blackhole**

use like `<cmd> > /dev/null 2>&1`

- Audit logs and levels
- Runtime security focus
- K8 doesn't have a built-in security features
- Short lifecycle of pods(containers) is a challenge for forensics during runtime and incident response
  - Audit logs
  - Syscalls monitoring (for syscalls made via running containers)
    - Can use some sidecar containers to monitor syscalls, e.g. Falco, some third-party tools, etc.
- RBAC and other runtime tools restricts access(allows to restrict the permissions and access to systm-resources) of the containers
  - Runs in kernel space
  - Ex: Seccomp, AppArmor, SELinux, etc.
- Falco and Sysdig are some of the tools that can be used to monitor the syscalls by running containers as sidecar containers or as a daemonset
- eBPF = extended Berkeley Packet Filter
  - Can be used to monitor the syscalls, network traffic, kernel space
- Kernel modules can be used to monitor the syscalls, using custom logic

**Falco**

- Define rules in YAML like format to monitor the syscalls and raise alerts on conditions met
  - Visibility and communication of alerts via : 
    - Falcosidekick : to send alerts to slack, AWS cloudwatch, other platforms
    - Prometheus : to collect monitored data with timestamp to prep time-series data
    - Grafana: to visualize the time-series data

```bash
Sun Sep 22 12:19:48 2024:    /etc/falco/falco.yaml
Sun Sep 22 12:19:48 2024: System info: Linux version 5.15.0-1056-aws (buildd@lcy02-amd64-059) (gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0, GNU ld (GNU Binutils for Ubuntu) 2.34) #61~20.04.1-Ubuntu SMP Wed Mar 13 17:40:41 UTC 2024
Sun Sep 22 12:19:48 2024: Loading rules from file /etc/falco/falco_rules.yaml
Sun Sep 22 12:19:48 2024: Loading rules from file /etc/falco/falco_rules.local.yaml
Sun Sep 22 12:19:48 2024: Loading rules from file /etc/falco/rules.d/custom-rules.yaml
Sun Sep 22 12:19:48 2024: Hostname value has been overridden via environment variable to: minikube
Sun Sep 22 12:19:48 2024: The chosen syscall buffer dimension is: 8388608 bytes (8 MBs)
Sun Sep 22 12:19:48 2024: Starting health webserver with threadiness 2, listening on 0.0.0.0:8765
Sun Sep 22 12:19:48 2024: Loaded event sources: syscall
Sun Sep 22 12:19:48 2024: Enabled event sources: syscall
Sun Sep 22 12:19:48 2024: Opening 'syscall' source with modern BPF probe.
Sun Sep 22 12:19:48 2024: One ring buffer every '2' CPUs.
12:19:52.708229253: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=calico gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995218407281288 proc_cwd= container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:19:52.776432981: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995214964107668 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:19:52.779064960: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995219646943774 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:19:57.782506922: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=calico gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995223482120849 proc_cwd= container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:19:57.842515200: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995220030197537 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:19:57.854004282: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995224721565265 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:02.860029973: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=calico gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995228559620371 proc_cwd= container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:03.044000992: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995225230671136 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:03.055093072: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995229922846546 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:08.061005883: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995233760298950 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:08.137385281: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995230324985818 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:08.142370219: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995235010235853 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:13.147510437: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995238847341845 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:13.269581331: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995235457143838 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:13.276201695: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995240143718568 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:18.285064237: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995243984288853 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:18.356850448: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=portmap gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995240544495855 proc_cwd= container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:18.360806312: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995245228704166 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:23.365552209: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995249065229886 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:23.424424063: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995245612095140 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:23.427789855: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995250295702429 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:28.431661698: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995254131456536 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:28.486551658: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995250673667933 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:28.491761487: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995255359560481 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:30.547885233: Critical Executing binary not part of base image (proc_exe=mount proc_sname=mount gparent=<NA> proc_exe_ino_ctime=1727006394311999884 proc_exe_ino_mtime=1645408197000000000 proc_exe_ino_ctime_duration_proc_start=1236227157477 proc_cwd= container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=mount proc_exepath=/usr/bin/mount parent=<NA> command=mount -t tmpfs -o size=4051730432 tmpfs /var/lib/kubelet/pods/a9fb7679-3b48-4a1d-b1f7-ff56b882cd2f/volumes/kubernetes.io~projected/kube-api-access-8hrkm terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.369312029: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/loopback proc_sname=loopback gparent=<NA> proc_exe_ino_ctime=1712012377684109902 proc_exe_ino_mtime=1712012377656108587 proc_exe_ino_ctime_duration_proc_start=14995253684729366 proc_cwd= container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=loopback proc_exepath=/opt/cni/bin/loopback parent=<NA> command=loopback terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.394963373: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995257094761761 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.469666294: Notice Unexpected connection to K8s API Server from container (connection=192.168.49.2:51892->10.96.0.1:443 lport=443 rport=51892 fd_type=ipv4 fd_proto=fd.l4proto evt_type=connect user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.516681535: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico-ipam proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012375584011328 proc_exe_ino_mtime=1712012375275996874 proc_exe_ino_ctime_duration_proc_start=14995255932442736 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico-ipam proc_exepath=/opt/cni/bin/calico-ipam parent=calico command=calico-ipam terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.567657850: Notice Unexpected connection to K8s API Server from container (connection=192.168.49.2:51898->10.96.0.1:443 lport=443 rport=51898 fd_type=ipv4 fd_proto=fd.l4proto evt_type=connect user=root user_uid=0 user_loginuid=-1 process=calico-ipam proc_exepath=/opt/cni/bin/calico-ipam parent=calico command=calico-ipam terminal=0 container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.807608603: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995253995261500 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:31.827745056: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995258692831430 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:32.371538673: Notice A shell was spawned in a container with an attached terminal (evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/usr/bin/dash parent=containerd-shim command=sh -c alias curl="curl --data '~/Downloads/c-johnson'";
while true; do sleep 1000; done
 terminal=34816 exe_flags=EXE_WRITABLE container_id=234e255cdcd2 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:33.502381325: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995259202156543 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:33.559432092: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995255746992169 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:33.564381160: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995260432103204 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:38.570941183: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995264270553211 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:38.639065721: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995260826443027 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:38.655666302: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995265522580972 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:43.667712305: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995269367455093 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:43.747721156: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995265935307242 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:43.752506603: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995270620162066 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:48.771185360: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995274468743620 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:49.047576295: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995271235193962 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:49.149523356: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995275998918133 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:54.184162861: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995279883926059 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:54.259326174: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995276446910461 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:54.263420819: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995281131257243 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:59.271849669: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995284971472757 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:59.369987316: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995281557568773 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:20:59.399114352: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995286266884716 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.554937604: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/loopback proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377684109902 proc_exe_ino_mtime=1712012377656108587 proc_exe_ino_ctime_duration_proc_start=14995282870608962 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=loopback proc_exepath=/opt/cni/bin/loopback parent=<NA> command=loopback terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.582583405: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995287450394209 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.599135045: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995282786667372 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.615068253: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995286314784981 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.672775483: Notice Unexpected connection to K8s API Server from container (connection=192.168.49.2:56420->10.96.0.1:443 lport=443 rport=56420 fd_type=ipv4 fd_proto=fd.l4proto evt_type=connect user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.766084422: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico-ipam proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012375584011328 proc_exe_ino_mtime=1712012375275996874 proc_exe_ino_ctime_duration_proc_start=14995285181442252 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico-ipam proc_exepath=/opt/cni/bin/calico-ipam parent=calico command=calico-ipam terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:00.961059491: Notice Unexpected connection to K8s API Server from container (connection=192.168.49.2:56422->10.96.0.1:443 lport=443 rport=56422 fd_type=ipv4 fd_proto=fd.l4proto evt_type=connect user=root user_uid=0 user_loginuid=-1 process=calico-ipam proc_exepath=/opt/cni/bin/calico-ipam parent=calico command=calico-ipam terminal=0 container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:01.408974800: Critical Executing binary not part of base image (proc_exe=umount proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1727006394311999884 proc_exe_ino_mtime=1645408197000000000 proc_exe_ino_ctime_duration_proc_start=1267096494794 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=umount proc_exepath=/usr/bin/umount parent=<NA> command=umount /var/lib/kubelet/pods/55662c71-354f-4dce-bba6-69a5270058ca/volumes/kubernetes.io~projected/kube-api-access-z9kjj terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:04.413519754: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995290113385282 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:04.579830918: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995286767491946 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:04.582897940: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/bandwidth proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995291450503323 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:09.614596604: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995295314333882 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:09.670321317: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/portmap proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012377812115912 proc_exe_ino_mtime=1712012377768113845 proc_exe_ino_ctime_duration_proc_start=14995291857832863 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=portmap proc_exepath=/opt/cni/bin/portmap parent=<NA> command=portmap terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:09.676181318: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/band width proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012373131896295 proc_exe_ino_mtime=1712012373087894231 proc_exe_ino_ctime_duration_proc_start=14995296543980872 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=bandwidth proc_exepath=/opt/cni/bin/bandwidth parent=<NA> command=bandwidth terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
12:21:14.684548748: Critical Executing binary not part of base image (proc_exe=/opt/cni/bin/calico proc_sname=<NA> gparent=<NA> proc_exe_ino_ctime=1712012374299951081 proc_exe_ino_mtime=1712012374279950143 proc_exe_ino_ctime_duration_proc_start=14995300384264856 proc_cwd=./ container_start_ts=1727006391659985915 evt_type=execve user=root user_uid=0 user_loginuid=-1 process=calico proc_exepath=/opt/cni/bin/calico parent=<NA> command=calico terminal=0 exe_flags=EXE_WRITABLE|EXE_UPPER_LAYER container_id=cd9ee77b8aa5 container_image=<NA> container_image_tag=<NA> container_name=<NA> k8s_ns=<NA> k8s_pod_name=<NA>)
ubuntu@tryhackme:~/Documents/falcoctl-local$ sed -n '439,449p' default_values.yaml | base64 -w 0
base64op
ubuntu@tryhackme:~/Documents/falcoctl-local$ kubectl logs falco-cctqg | grep curl
Defaulted container "falco" out of: falco, falco-driver-loader (init)
12:20:32.371538673: Notice A shell was spawned in a container with an attached terminal (evt_type=execve user=root user_uid=0 user_loginuid=-1 process=sh proc_exepath=/usr/bin/dash parent=containerd-shim command=sh -c alias curl="curl --data '~/Downloads/c-johnson'";
ubuntu@tryhackme:~/Documents/falcoctl-local$ ls ~/Downloads/c-johnson/
read-this-file.txt
ubuntu@tryhackme:~/Documents/falcoctl-local$ cat ~/Downloads/c-johnson/read-this-file.txt 
Salted__Z�v��BW�M�6��M0y�m�__��]����s|�ubuntu@tryhackme:~/Documents/falcoctl-local$ 
ubuntu@tryhackme:~/Documents/falcoctl-local$ sudo openssl enc -aes-256-cbc -d -in ~/Downloads/c-johnson/read-this-file.txt -out flag.txt -pass pass:"base64op"
*** WARNING : deprecated key derivation used.
Using -iter or -pbkdf2 would be better.
ubuntu@tryhackme:~/Documents/falcoctl-local$ ls
default_values.yaml  flag.txt  index.yaml
ubuntu@tryhackme:~/Documents/falcoctl-local$ cat flag.txt 
THM{some_flag_here}
ubuntu@tryhackme:~/Documents/falcoctl-local$ sed -n '439,449p' default_values.yaml              
    - rule: Detect Usage of Curl
      desc: Detects when the curl command is used inside a container.
      condition: >
        container.id != host and
        proc.name = curl and
        evt.type = execve
      output: >
        Curl command used in container (user=%user.name container=%container.name
        shell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)
      priority: WARNING
      tags: [network, command, security]  
ubuntu@tryhackme:~/Documents/falcoctl-local$
```

OffSec Questions::

Executing a ton of legit syscalls to mask the malicious ones. How???